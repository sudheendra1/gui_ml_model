<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Disease Predictor</title>
  </head>
  <body>
    <h1>Disease Predictor</h1>

    <form id="symptomForm">
      <label for="symptom1">Symptom 1:</label>
      <select name="symptoms" id="symptom1">
        <option value="">Select Symptom</option></select
      ><br />

      <label for="symptom2">Symptom 2:</label>
      <select name="symptoms" id="symptom2">
        <option value="">Select Symptom</option></select
      ><br />

      <label for="symptom3">Symptom 3:</label>
      <select name="symptoms" id="symptom3">
        <option value="">Select Symptom</option></select
      ><br />

      <label for="symptom4">Symptom 4:</label>
      <select name="symptoms" id="symptom4">
        <option value="">Select Symptom</option></select
      ><br />

      <label for="symptom5">Symptom 5:</label>
      <select name="symptoms" id="symptom5">
        <option value="">Select Symptom</option></select
      ><br />

      <label for="symptom6">Symptom 6:</label>
      <select name="symptoms" id="symptom6">
        <option value="">Select Symptom</option></select
      ><br />

      <button type="submit">Predict Disease</button>
    </form>

    <div id="result" style="display: none">
      <h2>Prediction Result:</h2>
      <p id="disease"></p>
      <p id="description"></p>
      <p id="precaution"></p>
      <p id="doctor"></p>
    </div>

    <script>
      // Function to populate dropdown menus with symptom options
      function populateDropdown(selectElement) {
        const symptoms = [
          "itching",
          "skin_rash",
          "nodal_skin_eruptions",
          "continuous_sneezing",
          "shivering",
          "chills",
          "joint_pain",
          "stomach_pain",
          "acidity",
          "ulcers_on_tongue",
          "muscle_wasting",
          "vomiting",
          "burning_micturition",
          "spotting_urination",
          "fatigue",
          "weight_gain",
          "anxiety",
          "cold_hands_and_feets",
          "mood_swings",
          "weight_loss",
          "restlessness",
          "lethargy",
          "patches_in_throat",
          "irregular_sugar_level",
          "cough",
          "high_fever",
          "sunken_eyes",
          "breathlessness",
          "sweating",
          "dehydration",
          "indigestion",
          "headache",
          "yellowish_skin",
          "dark_urine",
          "nausea",
          "loss_of_appetite",
          "pain_behind_the_eyes",
          "back_pain",
          "constipation",
          "abdominal_pain",
          "diarrhoea",
          "mild_fever",
          "yellow_urine",
          "yellowing_of_eyes",
          "acute_liver_failure",
          "fluid_overload",
          "swelling_of_stomach",
          "swelled_lymph_nodes",
          "malaise",
          "blurred_and_distorted_vision",
          "phlegm",
          "throat_irritation",
          "redness_of_eyes",
          "sinus_pressure",
          "runny_nose",
          "congestion",
          "chest_pain",
          "weakness_in_limbs",
          "fast_heart_rate",
          "pain_during_bowel_movements",
          "pain_in_anal_region",
          "bloody_stool",
          "irritation_in_anus",
          "neck_pain",
          "dizziness",
          "cramps",
          "bruising",
          "obesity",
          "swollen_legs",
          "swollen_blood_vessels",
          "puffy_face_and_eyes",
          "enlarged_thyroid",
          "brittle_nails",
          "swollen_extremeties",
          "excessive_hunger",
          "extra_marital_contacts",
          "drying_and_tingling_lips",
          "slurred_speech",
          "knee_pain",
          "hip_joint_pain",
          "muscle_weakness",
          "stiff_neck",
          "swelling_joints",
          "movement_stiffness",
          "spinning_movements",
          "loss_of_balance",
          "unsteadiness",
          "weakness_of_one_body_side",
          "loss_of_smell",
          "bladder_discomfort",
          "foul_smell_of_urine",
          "continuous_feel_of_urine",
          "passage_of_gases",
          "internal_itching",
          "toxic_look_(typhos)",
          "depression",
          "irritability",
          "muscle_pain",
          "altered_sensorium",
          "red_spots_over_body",
          "belly_pain",
          "abnormal_menstruation",
          "dischromic_patches",
          "watering_from_eyes",
          "increased_appetite",
          "polyuria",
          "family_history",
          "mucoid_sputum",
          "rusty_sputum",
          "lack_of_concentration",
          "visual_disturbances",
          "receiving_blood_transfusion",
          "receiving_unsterile_injections",
          "coma",
          "stomach_bleeding",
          "distention_of_abdomen",
          "history_of_alcohol_consumption",
          "fluid_overload",
          "blood_in_sputum",
          "prominent_veins_on_calf",
          "palpitations",
          "painful_walking",
          "pus_filled_pimples",
          "blackheads",
          "scurring",
          "skin_peeling",
          "silver_like_dusting",
          "small_dents_in_nails",
          "inflammatory_nails",
          "blister",
          "red_sore_around_nose",
          "yellow_crust_ooze",
        ];

        for (let symptom of symptoms) {
          let option = document.createElement("option");
          option.text = symptom;
          selectElement.add(option);
        }
      }

      // Populate dropdown menus with options
      for (let i = 1; i <= 6; i++) {
        let symptomSelect = document.getElementById("symptom" + i);
        populateDropdown(symptomSelect);
      }

      document
        .getElementById("symptomForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const formData = new FormData(event.target);
          const selectedSymptoms = [];

          for (let i = 1; i <= 6; i++) {
            let symptomSelect = document.getElementById("symptom" + i);
            let symptom = symptomSelect.value;
            if (symptom) {
              selectedSymptoms.push(symptom);
            }
          }
          console.log("Selected Symptoms:", selectedSymptoms);

          if (selectedSymptoms.length < 4 || selectedSymptoms.length > 6) {
            alert("Please provide between 4 to 6 symptoms.");
            return;
          }
          const payload = JSON.stringify({ symptoms: selectedSymptoms });
          console.log("POST Payload:", payload);

          fetch("/predict", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: payload,
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.error) {
                alert(data.error);
              } else {
                document.getElementById("disease").innerText =
                  "Predicted Disease: " + data.disease;
                document.getElementById("description").innerText =
                  "Description: " + data.description[0].Symptom_Description;

                // Extract and format precautions
                let precautions = "Precautions: ";
                for (let precaution of data.precaution) {
                  for (let key in precaution) {
                    if (
                      precaution[key].toLowerCase() !==
                      data.disease.toLowerCase()
                    ) {
                      precautions += precaution[key] + ", ";
                    }
                  }
                }
                document.getElementById("precaution").innerText =
                  precautions.slice(0, -2);

                // Extract and format doctors
                let doctors = "Specialists to Consult: ";
                for (let doctor of data.doctor) {
                  for (let key in doctor) {
                    if (
                      doctor[key].toLowerCase() !== data.disease.toLowerCase()
                    ) {
                      doctors += doctor[key] + ", ";
                    }
                  }
                }
                document.getElementById("doctor").innerText = doctors.slice(
                  0,
                  -2
                );

                document.getElementById("result").style.display = "block";
              }
            })
            .catch((error) => console.error("Error:", error));
        });
    </script>
  </body>
</html>
